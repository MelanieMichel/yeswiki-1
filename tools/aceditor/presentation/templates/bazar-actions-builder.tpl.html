<div class="modal fade" id="bazar-actions-modal" tabindex="-1" role="dialog" >
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h2 class="modal-title"><?php echo _t('ACEDITOR_ACTIONS_BAZAR'); ?></h2>
      </div>

      <!-- Modal Body -->
      <div id="bazar-actions-builder-app" class="modal-body">
        <!-- Choose form -->
        <div class="form-group">
          <label class="control-label"><?php echo _t('ACTION_BUILDER_CHOOSE_FORM'); ?></label>
          <select v-model="formId" required class="form-control">
            <option v-for="(name, id) in forms" :value="id">{{ name }}</option>
          </select>
        </div>

        <!-- Choose Bazar Action -->
        <div class="form-group">
          <label class="control-label"><?php echo _t('ACTION_BUILDER_CHOOSE_ACTION'); ?></label>
          <select v-model="selectedActionId" required class="form-control">
            <option v-for="(action, actionId) in actions" :value="actionId">{{ action.label }}</option>
          </select>
        </div>

        <!-- Action Parameters -->
        <div v-if="selectedAction">
          <div class="alert alert-info">{{ selectedAction.description }}</div>
          <h3><?php echo _t('ACTION_BUILDER_PARAMETERS') ?></h3>
          <div class="form-group" v-for="(property, propName) in selectedAction.properties">
              <label v-if="property.label" class="control-label">{{ property.label }}</label>
              <!-- Text Property -->
              <template v-if="property.type == 'text'">
                <input type="text" v-model="values[propName]" class="form-control" :required="property.required"/>
              </template>
              <!-- List Property -->
              <template v-else-if="property.type == 'list'">
                <select class="form-control" v-model="values[propName]" :required="property.required">
                  <option v-for="option in property.options" :value="option" >{{ option }}</option>
                </select>
              </template>
              <!-- Other Property -->
              <template v-else>
                <input type="hidden" v-model="values[propName]" />
              </template>
          </div>

          <h3><?php echo _t('ACTION_BUILDER_WIKI_CODE_TITLE') ?></h3>
          <div class="input-group result-container">
            <div class="input-group-addon btn btn-primary" @click="copyContent"><?php echo _t('ACTION_BUILDER_COPY') ?></div>
            <input type="text" class="result form-control" @click="selectFullText" :value="wikiCode" ref="wikiCode">
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default btn-block" data-dismiss="modal">Close</button>
      </div>

    </div>
  </div>
</div>

<script>
  // Not very elegant, but avoid doing an ajax request from vue component to retrieve the Json data
  var data = <?php echo json_encode($data) ?>;
</script>

<?php
  // $GLOBALS['wiki']->addJavascriptFile('libs/vue.min.js');
  $GLOBALS['wiki']->addJavascriptFile('libs/vue.js'); // For dev only
  $GLOBALS['wiki']->addJavascriptFile('tools/aceditor/presentation/javascripts/bazar-actions-builder.js');
  $GLOBALS['wiki']->addCSSFile('tools/aceditor/presentation/styles/bazar-actions-builder.css');
?>
